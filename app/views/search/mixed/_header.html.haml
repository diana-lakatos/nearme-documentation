%header#listing_search.container-fluid.mixed{class: @searcher.transactable_type.default_search_view.present? ? 'with-toggle' : ''}
  .header-inner
    %form.search_results{:action => search_path(v: @searcher.result_view), :method => "get"}
      = hidden_field_tag :transactable_type_id, @searcher.transactable_type.id
      = hidden_field_tag :lntype, @searcher.search.lntype
      = hidden_field_tag :category_ids, @searcher.search.category_ids
      = hidden_field_tag :lgpricing, @searcher.search.lgpricing
      - @searcher.filterable_custom_attributes.each do |ca|
        = hidden_field_tag "lg_custom_attributes[#{ca.name}]", @searcher.search.lg_custom_attributes[ca.name]
      - if @searcher.transactable_type.show_date_pickers
        = hidden_field_tag :start_date, @searcher.search.display_dates[:start]
        = hidden_field_tag :end_date, @searcher.search.display_dates[:end]
        = hidden_field_tag 'availability[dates][start]', @searcher.search.start_date
        = hidden_field_tag 'availability[dates][end]', @searcher.search.end_date

      .row-fluid
        .span12
          .list-map-toggle.span2
            %a.list{ href: search_path(params.merge(v: 'list')), class: active_class(@searcher.result_view, 'list'), title: t('search.header.list'), data: { view: 'list' } }
              = t('search.header.list')
            %a.map{ href: search_path(params.merge(v: @searcher.transactable_type.other_search_view)), class: active_class(@searcher.result_view, @searcher.transactable_type.other_search_view), title: t('search.header.map'), data: { view: @searcher.transactable_type.other_search_view } }
              = t('search.header.map')
          .geolocation-input{ :class => (@searcher.transactable_type.fulltext_geo_search? ? 'span4' : 'span8')}
            .geolocation
              %span.ico-crosshairs
              .geo-loading.text-center(data-loading style='display: none')
                = image_tag('spinner.gif', width: '16', style: 'margin-left: -15px;')

            %input#search.query{:name => @searcher.transactable_type.search_input_name, :placeholder => @searcher.transactable_type.search_field_placeholder, :type => "text", :value => @searcher.input_value(@searcher.transactable_type.search_input_name), :autocomplete => "off", 'data-disable-autocomplete' => @searcher.transactable_type.fulltext_search?}
          -if @searcher.transactable_type.fulltext_geo_search?
            .keyword-input.span4
              .search-loop-icon
                %span.ico-search
              %input.query{:name => "query", :placeholder => @searcher.transactable_type.fulltext_placeholder, :type => "text", :value => @searcher.keyword, :autocomplete => "off"}
          .search-icon.btn.btn-green.span2
            %span.ico-search
              %span.text= t 'homepage.buttons.search'

      - search_geofields.each do |geofield|
        = hidden_field_tag geofield, params.fetch(geofield, '')
      = hidden_field_tag :sort, @searcher.search.sort
      = hidden_field_tag :v, @searcher.result_view
      = hidden_field_tag :ignore_search_event, 0
      = hidden_field_tag :page, 1
      = hidden_field_tag :per_page, per_page
      = hidden_field_tag 'price[min]', @searcher.current_min_price
      = hidden_field_tag 'price[max]', @searcher.current_max_price
