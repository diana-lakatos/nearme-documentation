- title t('dashboard.nav.transfers')

.dash-page
  .dash-head.clearfix
    %p= t('dashboard.nav.transfers')
  .dash-body
    - if @last_week_payment_transfers.empty?
      %p.no_data.text-center= t('dashboard.transfers.no_transfers_last_week')
    - else
      .chart
        .total.right
          - @chart.totals_by_currency.each do |currency, sum|
            .total-number.left
              = "#{currency_content_tag(currency, sum, :span, { :rel => false })}".html_safe
          %span{class: 'total-text'} 7 day total
        %canvas#chart

    - unless @company.any_payout_option_available?
      %p.warning.text-center
        %i.ico-warning
        = t('dashboard.transfers.cannot_transfer')
        = link_to t('dashboard.transfers.setup'), edit_dashboard_company_payouts_path
    - if @payment_transfers.present?
      .table-responsive
        %table.table.table-simple
          %thead
            %tr
              %th Gross
              %th Fees
              %th Total
              %th Transferred
          %tbody
            - @payment_transfers.each do |payment_transfer|
              %tr
                %td
                  = currency_content_tag(payment_transfer.currency, payment_transfer.gross_amount - payment_transfer.service_fee_amount_guest, :span)
                %td
                  = currency_content_tag(payment_transfer.currency, payment_transfer.service_fee_amount_host, :span)
                %td
                  = currency_content_tag(payment_transfer.currency, payment_transfer.amount, :span)
                %td
                  - if payment_transfer.transferred_at.present?
                    = l(payment_transfer.transferred_at, format: :short)
                  - else
                    %i.ico-warning
                    = t('dashboard.transfers.not_transferred')

      = will_paginate_styled @payment_transfers

- content_for :domready do
  $(document).trigger('linechart.dnm', [$('#chart'), #{@chart.values.to_json.html_safe}, #{@chart.labels.to_json.html_safe}]);
